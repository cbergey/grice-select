---
title: "griceselectanalysismturk"
output: html_document
---

```{r load_libraries}
library(tidyverse)
library(here)
library(ggthemes)
library(tidyboot)

theme_set(theme_classic(base_size = 18))
```

```{r read_data}
data <- read_csv(here("data/turk_data.csv")) %>%
  gather(item, chose, chosetarget, choselure, choseunique) %>%
  mutate(item = gsub("chose", "", item))
```

```{r keep_subjs}
keep_subjs <- data %>%
  filter(searchtype == "uniquetarget", adjective_used, item == "target") %>%
  group_by(subid) %>%
  summarise(n = mean(chose)) %>%
  filter(n == 1)
```

```{r mean}
mean_data <- data %>%
  filter(item != "unique") %>%
  group_by(type, searchtype, adjective_used, item, subid) %>%
  summarise(chose = mean(chose), n = n()) %>%
  tidyboot_mean(chose) %>%
  ungroup() %>%
  mutate(adjective_used = factor(adjective_used, labels = c("noun", "adjective noun")))
```

```{r unique, fig.width = 10}
ggplot(mean_data %>% filter(searchtype == "uniquetarget", item == "target"), 
       aes(x = adjective_used, color = type)) +
  geom_pointrange(aes(ymin = ci_lower, ymax = ci_upper, y = empirical_stat),
                  position = position_dodge(.5)) + 
  scale_color_ptol() + 
  ylab("Item chosen") + 
  xlab("")
```

```{r sedivy, fig.width = 10}
ggplot(mean_data %>% filter(searchtype == "sedivy"), 
       aes(x = type, color = adjective_used)) +
  facet_wrap(~ item) +
  geom_pointrange(aes(ymin = ci_lower, ymax = ci_upper, y = empirical_stat),
                  position = position_dodge(.5)) + 
  scale_color_ptol() + 
  ylab("Item chosen") + 
  xlab("")
```